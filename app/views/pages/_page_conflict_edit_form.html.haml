= form_for(page) do |f|
  = f.hidden_field :lock_version

  %ul.red
    - if page.history.last
      - page.history.last.errors.full_messages.each do |msg|
        %li= msg
    - page.errors.full_messages.each do |msg|
      %li= msg

  Please edit to resolve the differences shown below.
  %br/
  %br/
  What you wanted is shown in red.
  %br/
  What the page currently contains is in green.
  %br/
  %br/
  The current contents are shown in the edit boxes,
  %br/
  ready for your further changes.



  - if page.title != conflict.title
    %h3 Title differs
    %br/
    .width-500px
      = (page.compare_versions conflict.title, page.title).html_safe
      %br
      = f.text_field :title
    %br/
  -else
    = f.hidden_field :title

  - if page.page_type != conflict.page_type
    %h3 Page type differs
    %br/
    .width-500px
      = (page.compare_versions conflict.page_type, page.page_type).html_safe
      = f.select :page_type, page.ld_page_type.collect{|t| [t[0], t[0]] }
    %br/
  -else
    = f.hidden_field :page_type

  - if page.categories != conflict.categories
    %h3  Categories differ
    %br/
    .width-500px
      = (page.compare_versions conflict.categories, page.categories).html_safe
      %br
      = f.text_field :categories
  - else
    = f.hidden_field :categories


  - if page.tags != conflict.tags
    %h3  Tags differ
    %br/
    .width-500px
      = (page.compare_versions conflict.tags, page.tags).html_safe
      %br
      = f.text_field :tags
  - else
    = f.hidden_field :tags

  - #TODO see if UMCS Collection is a page_type
  - if page.has_page_type? 'UMCS Collection'

    .width-500px
      - if page.item_number != conflict.item_number
        %h3  UMCS colletion item number differs
        %br/
        = (page.compare_versions conflict.item_number, page.item_number).html_safe
        %br
        = f.text_field :tags
      - else
        = f.hidden_field :tags

    .width-500px
      - if page.location != conflict.location
        %h3  UMCS colletion location differs
        %br/
        = (page.compare_versions conflict.location, page.location).html_safe
        %br
        = f.text_field :location
      - else
        = f.hidden_field :location

  - if page.content != conflict.content
    %h3  Content differs
    %br/
    .width-500px
      = (page.compare_versions conflict.content, page.content).html_safe
      %br/
      = f.text_area :content
  - else
    = f.hidden_field :content

  %br
  = f.submit class: 'btn btn-primary'


